for (real t=0.;t<=TF;t+=dt) {
	plot(H,HU,HV,dim=3,cmm="t="+t,wait=0.,value=true,fill=true);
	
	solve PH(u, v,init=op) = int2d(Th)(u*v)-int2d(Th)((H-(FHp12-FHm12)*dt/DX-(GHp12-GHm12)*dt/DY+SU*dt)*v);
	H=u;
	solve PHU(u, v, init=op)=int2d(Th)(u*v)-int2d(Th)((HU-(FHUp12-FHUm12)*dt/DX-(GHUp12-GHUm12)*dt/DY+SHU*dt/DX)*v);
	HU=u;
	solve PHV(u, v, init=op)=int2d(Th)(u*v)-int2d(Th)((HV-(FHVp12-FHVm12)*dt/DX-(GHVp12-GHVm12)*dt/DY+SHV*dt/DY)*v);
	HV=u;

	op=1;
}
